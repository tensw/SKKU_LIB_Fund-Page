<mxfile host="app.diagrams.net" modified="2026-02-23" agent="Claude Code" version="24.0.0" type="device">
  <diagram id="skku-donors-architecture" name="Backend Architecture">
    <mxGraphModel dx="1600" dy="1000" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1600" pageHeight="1200" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />

        <!-- Title -->
        <mxCell id="title" value="SKKU Donors - Backend Architecture" style="text;html=1;fontSize=24;fontStyle=1;align=center;verticalAlign=middle;fillColor=none;strokeColor=none;fontColor=#1B3A5C;" vertex="1" parent="1">
          <mxGeometry x="450" y="20" width="500" height="40" as="geometry" />
        </mxCell>
        <mxCell id="subtitle" value="Next.js 16 + Prisma + SQLite | 성균관대학교 학술정보관 발전기금 시스템" style="text;html=1;fontSize=12;align=center;verticalAlign=middle;fillColor=none;strokeColor=none;fontColor=#6B7280;" vertex="1" parent="1">
          <mxGeometry x="400" y="55" width="600" height="25" as="geometry" />
        </mxCell>

        <!-- ==================== CLIENT LAYER ==================== -->
        <mxCell id="client-group" value="Client Layer (Browser)" style="swimlane;startSize=30;fillColor=#E8F0FE;strokeColor=#1B3A5C;fontStyle=1;fontSize=13;fontColor=#1B3A5C;rounded=1;arcSize=8;" vertex="1" parent="1">
          <mxGeometry x="40" y="100" width="1320" height="200" as="geometry" />
        </mxCell>

        <!-- Public Pages -->
        <mxCell id="public-group" value="Public Pages" style="swimlane;startSize=25;fillColor=#FFFFFF;strokeColor=#1B3A5C;fontSize=11;fontStyle=1;fontColor=#1B3A5C;rounded=1;" vertex="1" parent="client-group">
          <mxGeometry x="20" y="40" width="780" height="145" as="geometry" />
        </mxCell>
        <mxCell id="hero" value="HeroSection&#xa;(Hero 배너)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#1B3A5C;fontColor=#FFFFFF;strokeColor=#1B3A5C;fontSize=10;" vertex="1" parent="public-group">
          <mxGeometry x="10" y="35" width="110" height="50" as="geometry" />
        </mxCell>
        <mxCell id="vision" value="ProjectVision&#xa;(프로젝트 소개)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#1B3A5C;fontColor=#FFFFFF;strokeColor=#1B3A5C;fontSize=10;" vertex="1" parent="public-group">
          <mxGeometry x="130" y="35" width="110" height="50" as="geometry" />
        </mxCell>
        <mxCell id="status" value="DonationStatus&#xa;(기부현황)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#C8102E;fontColor=#FFFFFF;strokeColor=#C8102E;fontSize=10;" vertex="1" parent="public-group">
          <mxGeometry x="250" y="35" width="110" height="50" as="geometry" />
        </mxCell>
        <mxCell id="donorlist" value="DonorList&#xa;(기부자 명단)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#C8102E;fontColor=#FFFFFF;strokeColor=#C8102E;fontSize=10;" vertex="1" parent="public-group">
          <mxGeometry x="370" y="35" width="110" height="50" as="geometry" />
        </mxCell>
        <mxCell id="benefits" value="DonorBenefits&#xa;(기부자 예우)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#1B3A5C;fontColor=#FFFFFF;strokeColor=#1B3A5C;fontSize=10;" vertex="1" parent="public-group">
          <mxGeometry x="490" y="35" width="110" height="50" as="geometry" />
        </mxCell>
        <mxCell id="guide" value="DonationGuide&#xa;(기부안내/연락처)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#1B3A5C;fontColor=#FFFFFF;strokeColor=#1B3A5C;fontSize=10;" vertex="1" parent="public-group">
          <mxGeometry x="610" y="35" width="120" height="50" as="geometry" />
        </mxCell>
        <mxCell id="sectionnav" value="SectionNav (Sticky Navigation)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#E5E2DC;fontColor=#1F222D;strokeColor=#6B7280;fontSize=10;" vertex="1" parent="public-group">
          <mxGeometry x="10" y="100" width="720" height="30" as="geometry" />
        </mxCell>

        <!-- Admin Pages -->
        <mxCell id="admin-group" value="Admin Pages (Protected)" style="swimlane;startSize=25;fillColor=#FFFFFF;strokeColor=#C8102E;fontSize=11;fontStyle=1;fontColor=#C8102E;rounded=1;" vertex="1" parent="client-group">
          <mxGeometry x="820" y="40" width="480" height="145" as="geometry" />
        </mxCell>
        <mxCell id="admin-login" value="Login Page&#xa;/admin/login" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#F8F6F2;fontColor=#1F222D;strokeColor=#E5E2DC;fontSize=10;" vertex="1" parent="admin-group">
          <mxGeometry x="15" y="35" width="130" height="50" as="geometry" />
        </mxCell>
        <mxCell id="admin-dashboard" value="Dashboard&#xa;/admin&#xa;(KPI + Charts)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#00563F;fontColor=#FFFFFF;strokeColor=#00563F;fontSize=10;" vertex="1" parent="admin-group">
          <mxGeometry x="165" y="35" width="130" height="50" as="geometry" />
        </mxCell>
        <mxCell id="admin-upload" value="Excel Upload&#xa;/admin/upload&#xa;(XLSX 파싱)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#00563F;fontColor=#FFFFFF;strokeColor=#00563F;fontSize=10;" vertex="1" parent="admin-group">
          <mxGeometry x="315" y="35" width="145" height="50" as="geometry" />
        </mxCell>
        <mxCell id="admin-layout" value="Admin Layout (Sidebar + Auth Guard)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#E5E2DC;fontColor=#1F222D;strokeColor=#6B7280;fontSize=10;" vertex="1" parent="admin-group">
          <mxGeometry x="15" y="100" width="445" height="30" as="geometry" />
        </mxCell>

        <!-- ==================== MIDDLEWARE LAYER ==================== -->
        <mxCell id="middleware-group" value="Middleware Layer" style="swimlane;startSize=30;fillColor=#FFF3CD;strokeColor=#F59E0B;fontStyle=1;fontSize=13;fontColor=#92400E;rounded=1;arcSize=8;" vertex="1" parent="1">
          <mxGeometry x="40" y="320" width="1320" height="80" as="geometry" />
        </mxCell>
        <mxCell id="middleware" value="Next.js Middleware (src/middleware.ts)&#xa;/admin/* 경로 보호 | Cookie 기반 인증 (admin-token) | /admin/login 및 /api/* 는 통과" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;fontColor=#92400E;strokeColor=#F59E0B;fontSize=11;" vertex="1" parent="middleware-group">
          <mxGeometry x="20" y="35" width="1280" height="35" as="geometry" />
        </mxCell>

        <!-- ==================== API LAYER ==================== -->
        <mxCell id="api-group" value="API Layer (Next.js Route Handlers)" style="swimlane;startSize=30;fillColor=#E8F5E9;strokeColor=#00563F;fontStyle=1;fontSize=13;fontColor=#00563F;rounded=1;arcSize=8;" vertex="1" parent="1">
          <mxGeometry x="40" y="420" width="1320" height="220" as="geometry" />
        </mxCell>

        <!-- Auth API -->
        <mxCell id="auth-api" value="POST /api/admin/auth&#xa;(로그인 - 비밀번호 검증 → Cookie 발급)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;fontColor=#1F222D;strokeColor=#00563F;fontSize=10;" vertex="1" parent="api-group">
          <mxGeometry x="20" y="40" width="250" height="50" as="geometry" />
        </mxCell>
        <mxCell id="auth-logout" value="DELETE /api/admin/auth&#xa;(로그아웃 - Cookie 삭제)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;fontColor=#1F222D;strokeColor=#00563F;fontSize=10;" vertex="1" parent="api-group">
          <mxGeometry x="20" y="100" width="250" height="50" as="geometry" />
        </mxCell>

        <!-- Upload API -->
        <mxCell id="upload-api" value="POST /api/admin/upload&#xa;(엑셀 업로드 → 파싱 → DB 저장)&#xa;&#xa;- XLSX 라이브러리로 파싱&#xa;- 유연한 헤더 매칭&#xa;- 날짜/금액 자동 변환" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;fontColor=#1F222D;strokeColor=#00563F;fontSize=10;align=left;spacingLeft=10;" vertex="1" parent="api-group">
          <mxGeometry x="290" y="40" width="240" height="110" as="geometry" />
        </mxCell>

        <!-- Donations API -->
        <mxCell id="donations-list" value="GET /api/donations&#xa;(기부목록 - 페이징/검색/필터/정렬)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;fontColor=#1F222D;strokeColor=#00563F;fontSize=10;" vertex="1" parent="api-group">
          <mxGeometry x="550" y="40" width="240" height="50" as="geometry" />
        </mxCell>
        <mxCell id="donations-summary" value="GET /api/donations/summary&#xa;(요약 - 총건수/총액/용도별 집계)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;fontColor=#1F222D;strokeColor=#00563F;fontSize=10;" vertex="1" parent="api-group">
          <mxGeometry x="550" y="100" width="240" height="50" as="geometry" />
        </mxCell>
        <mxCell id="donations-analytics" value="GET /api/donations/analytics&#xa;(분석 - 월별추이/용도별/유형별/기간필터)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;fontColor=#1F222D;strokeColor=#00563F;fontSize=10;" vertex="1" parent="api-group">
          <mxGeometry x="810" y="40" width="260" height="50" as="geometry" />
        </mxCell>
        <mxCell id="donations-export" value="GET /api/donations/export&#xa;(엑셀 다운로드 - XLSX 파일 생성)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;fontColor=#1F222D;strokeColor=#00563F;fontSize=10;" vertex="1" parent="api-group">
          <mxGeometry x="810" y="100" width="260" height="50" as="geometry" />
        </mxCell>

        <!-- API Labels -->
        <mxCell id="api-label-auth" value="Admin Auth" style="text;html=1;fontSize=10;fontStyle=1;align=center;fillColor=#00563F;fontColor=#FFFFFF;strokeColor=none;rounded=1;" vertex="1" parent="api-group">
          <mxGeometry x="75" y="160" width="80" height="22" as="geometry" />
        </mxCell>
        <mxCell id="api-label-upload" value="Data Import" style="text;html=1;fontSize=10;fontStyle=1;align=center;fillColor=#00563F;fontColor=#FFFFFF;strokeColor=none;rounded=1;" vertex="1" parent="api-group">
          <mxGeometry x="360" y="160" width="80" height="22" as="geometry" />
        </mxCell>
        <mxCell id="api-label-read" value="Data Read (Public)" style="text;html=1;fontSize=10;fontStyle=1;align=center;fillColor=#C8102E;fontColor=#FFFFFF;strokeColor=none;rounded=1;" vertex="1" parent="api-group">
          <mxGeometry x="710" y="160" width="120" height="22" as="geometry" />
        </mxCell>

        <!-- ==================== DATA LAYER ==================== -->
        <mxCell id="data-group" value="Data Layer" style="swimlane;startSize=30;fillColor=#F3E8FF;strokeColor=#7C3AED;fontStyle=1;fontSize=13;fontColor=#7C3AED;rounded=1;arcSize=8;" vertex="1" parent="1">
          <mxGeometry x="40" y="660" width="1320" height="200" as="geometry" />
        </mxCell>

        <!-- Prisma -->
        <mxCell id="prisma" value="Prisma ORM&#xa;(src/lib/prisma.ts)&#xa;&#xa;Singleton Pattern&#xa;Dev: Global Instance 재사용" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#7C3AED;fontColor=#FFFFFF;strokeColor=#7C3AED;fontSize=11;align=center;" vertex="1" parent="data-group">
          <mxGeometry x="20" y="40" width="200" height="90" as="geometry" />
        </mxCell>

        <!-- Database -->
        <mxCell id="sqlite" value="SQLite Database&#xa;(prisma/donations.db)" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=15;fillColor=#7C3AED;fontColor=#FFFFFF;strokeColor=#5B21B6;fontSize=11;" vertex="1" parent="data-group">
          <mxGeometry x="290" y="40" width="160" height="90" as="geometry" />
        </mxCell>

        <!-- Schema -->
        <mxCell id="schema" value="Donation Model&#xa;&#xa;id: Int (PK, Auto)&#xa;name: String&#xa;donorType: String&#xa;amount: BigInt&#xa;donatedAt: DateTime&#xa;purpose: String&#xa;note: String?&#xa;createdAt: DateTime" style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;size=20;fillColor=#FFFFFF;fontColor=#1F222D;strokeColor=#7C3AED;fontSize=10;align=left;spacingLeft=10;" vertex="1" parent="data-group">
          <mxGeometry x="520" y="30" width="180" height="160" as="geometry" />
        </mxCell>

        <!-- Seed -->
        <mxCell id="seed" value="Seed Data&#xa;(prisma/seed.ts)&#xa;&#xa;30건 샘플 데이터&#xa;- 도서관 발전기금 (15건)&#xa;- 1398 LibraryON (15건)" style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;size=20;fillColor=#FFFFFF;fontColor=#1F222D;strokeColor=#7C3AED;fontSize=10;align=left;spacingLeft=10;" vertex="1" parent="data-group">
          <mxGeometry x="740" y="30" width="190" height="130" as="geometry" />
        </mxCell>

        <!-- External Services -->
        <mxCell id="ext-group" value="External Services" style="swimlane;startSize=25;fillColor=#FFF0F0;strokeColor=#C8102E;fontSize=11;fontStyle=1;fontColor=#C8102E;rounded=1;" vertex="1" parent="data-group">
          <mxGeometry x="980" y="30" width="320" height="130" as="geometry" />
        </mxCell>
        <mxCell id="env" value=".env&#xa;ADMIN_PASSWORD" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;fontColor=#1F222D;strokeColor=#C8102E;fontSize=10;" vertex="1" parent="ext-group">
          <mxGeometry x="15" y="35" width="130" height="40" as="geometry" />
        </mxCell>
        <mxCell id="give-skku" value="give.skku.edu&#xa;(기부 결제 외부링크)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;fontColor=#1F222D;strokeColor=#C8102E;fontSize=10;" vertex="1" parent="ext-group">
          <mxGeometry x="165" y="35" width="140" height="40" as="geometry" />
        </mxCell>
        <mxCell id="xlsx-lib" value="xlsx (SheetJS)&#xa;Excel 파싱/생성" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;fontColor=#1F222D;strokeColor=#C8102E;fontSize=10;" vertex="1" parent="ext-group">
          <mxGeometry x="15" y="80" width="130" height="40" as="geometry" />
        </mxCell>

        <!-- ==================== ARROWS ==================== -->
        <!-- Client → API -->
        <mxCell id="arr1" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#1B3A5C;strokeWidth=1.5;exitX=0.5;exitY=1;entryX=0.5;entryY=0;" edge="1" parent="1" source="status" target="middleware">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="350" y="295" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="arr1-label" value="fetch()" style="edgeLabel;html=1;fontSize=9;fontColor=#6B7280;" connectable="0" vertex="1" parent="arr1">
          <mxGeometry x="-0.2" relative="1" as="geometry"><mxPoint as="offset" /></mxGeometry>
        </mxCell>

        <mxCell id="arr2" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#1B3A5C;strokeWidth=1.5;" edge="1" parent="1" source="donorlist" target="middleware">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <mxCell id="arr3" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#C8102E;strokeWidth=1.5;" edge="1" parent="1" source="admin-dashboard" target="middleware">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <mxCell id="arr4" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#C8102E;strokeWidth=1.5;" edge="1" parent="1" source="admin-upload" target="middleware">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <!-- Middleware → API -->
        <mxCell id="arr5" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#F59E0B;strokeWidth=2;" edge="1" parent="1" source="middleware-group" target="api-group">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arr5-label" value="Route → API Handler" style="edgeLabel;html=1;fontSize=9;fontColor=#92400E;" connectable="0" vertex="1" parent="arr5">
          <mxGeometry x="-0.2" relative="1" as="geometry"><mxPoint as="offset" /></mxGeometry>
        </mxCell>

        <!-- API → Prisma -->
        <mxCell id="arr6" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#00563F;strokeWidth=2;" edge="1" parent="1" source="api-group" target="prisma">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arr6-label" value="Prisma Client" style="edgeLabel;html=1;fontSize=9;fontColor=#00563F;" connectable="0" vertex="1" parent="arr6">
          <mxGeometry x="-0.2" relative="1" as="geometry"><mxPoint as="offset" /></mxGeometry>
        </mxCell>

        <!-- Prisma → SQLite -->
        <mxCell id="arr7" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#7C3AED;strokeWidth=2;" edge="1" parent="1" source="prisma" target="sqlite">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arr7-label" value="SQL" style="edgeLabel;html=1;fontSize=9;fontColor=#7C3AED;" connectable="0" vertex="1" parent="arr7">
          <mxGeometry relative="1" as="geometry"><mxPoint as="offset" /></mxGeometry>
        </mxCell>

        <!-- Schema arrow -->
        <mxCell id="arr8" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#7C3AED;strokeWidth=1;dashed=1;" edge="1" parent="1" source="sqlite" target="schema">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <!-- ==================== LEGEND ==================== -->
        <mxCell id="legend" value="" style="swimlane;startSize=25;fillColor=#FFFFFF;strokeColor=#E5E2DC;fontSize=11;fontStyle=1;fontColor=#1F222D;rounded=1;" vertex="1" parent="1">
          <mxGeometry x="40" y="880" width="600" height="100" as="geometry" />
        </mxCell>
        <mxCell id="leg1" value="Public (인증 불필요)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#C8102E;fontColor=#FFFFFF;strokeColor=#C8102E;fontSize=9;" vertex="1" parent="legend">
          <mxGeometry x="10" y="35" width="130" height="25" as="geometry" />
        </mxCell>
        <mxCell id="leg2" value="Static (서버사이드 불필요)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#1B3A5C;fontColor=#FFFFFF;strokeColor=#1B3A5C;fontSize=9;" vertex="1" parent="legend">
          <mxGeometry x="150" y="35" width="140" height="25" as="geometry" />
        </mxCell>
        <mxCell id="leg3" value="Admin (인증 필요)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#00563F;fontColor=#FFFFFF;strokeColor=#00563F;fontSize=9;" vertex="1" parent="legend">
          <mxGeometry x="300" y="35" width="130" height="25" as="geometry" />
        </mxCell>
        <mxCell id="leg4" value="Data Layer" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#7C3AED;fontColor=#FFFFFF;strokeColor=#7C3AED;fontSize=9;" vertex="1" parent="legend">
          <mxGeometry x="440" y="35" width="130" height="25" as="geometry" />
        </mxCell>
        <mxCell id="leg5" value="Tech Stack: Next.js 16 | React 19 | Prisma 6 | SQLite | Tailwind 4 | Recharts | Framer Motion | SheetJS" style="text;html=1;fontSize=10;align=left;fillColor=none;strokeColor=none;fontColor=#6B7280;" vertex="1" parent="legend">
          <mxGeometry x="10" y="70" width="570" height="20" as="geometry" />
        </mxCell>

      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
